---
import { formatDate, getReadingTime } from "@/utils/posts";

interface Props {
  title: string;
  description: string;
  pubDatetime: Date;
  modDatetime?: Date;
  slug: string;
  body?: string;
}

const {
  title,
  description,
  pubDatetime,
  modDatetime,
  slug,
  body = "",
} = Astro.props;
const readTime = getReadingTime(body);
---

<li class="my-8 -mx-4 rounded-lg px-4 py-2 transition-colors hover:bg-muted/20">
  <div>
    <a
      href={`/posts/${slug}/`}
      class="inline-block text-lg font-medium text-accent decoration-dashed underline-offset-4 focus-visible:no-underline focus-visible:underline-offset-0"
    >
      <h3
        class="text-lg font-medium decoration-dashed hover:underline"
        style={`view-transition-name: ${slug.replace(/\//g, "-")}`}
      >
        {title}
      </h3>
    </a>
    <div class="mb-3 flex items-center gap-3">
      <div class="flex items-center gap-2 opacity-80">
        <svg
          class="inline-block size-5 min-w-[1.25rem]"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        {
          modDatetime && modDatetime > pubDatetime ? (
            <span class="text-sm italic">Updated:</span>
          ) : (
            <span class="sr-only">Published:</span>
          )
        }
        <span class="text-sm italic">
          <time
            datetime={(modDatetime && modDatetime > pubDatetime
              ? modDatetime
              : pubDatetime
            ).toISOString()}
          >
            {formatDate(
              modDatetime && modDatetime > pubDatetime
                ? modDatetime
                : pubDatetime
            )}
          </time>
        </span>
      </div>
      <span class="text-sm italic opacity-80">&bull; {readTime}</span>
    </div>
    <p class="opacity-80">{description}</p>
  </div>
</li>
